{% extends 'base.html' %}
{% load static %}
{% block simulator_content %}

<div class="container mt-4">
    {% include 'simulator_config.html' %}

    <div id="lineups-section" style="display: none;">
        <div class="d-flex justify-content-between align-items-center my-3">
            <div>
                <button class="btn btn-navigation" id="prev-lineup" disabled>
                    <i class="bi bi-chevron-left"></i> Previous
                </button>
                <button class="btn btn-navigation" id="next-lineup">
                    Next <i class="bi bi-chevron-right"></i>
                </button>
            </div>
            <div>
                Lineup <span id="current-lineup">1</span> of <span id="total-lineups">0</span>
            </div>
            <div class="d-flex align-items-center gap-2">
                <button id="reupload-btn" class="btn btn-secondary">
                    <i class="bi bi-upload"></i> Re-upload Files
                </button>
                <a href="#" id="download-csv" class="btn btn-secondary" style="display: none;">
                    <i class="bi bi-download"></i> Download Lineups
                </a>
                <a href="#" id="download-exposures" class="btn btn-secondary" style="display: none;">
                    <i class="bi bi-download"></i> Download Exposures
                </a>
            </div>
        </div>

        <div class="table-responsive">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Position</th>
                        <th>Player</th>
                        <th>Team</th>
                        <th>Opponent</th>
                        <th>Salary</th>
                        <th>Proj. Pts</th>
                        <th>Field Proj.</th>
                        <th>Own %</th>
                    </tr>
                </thead>
                <tbody id="lineup-body">
                </tbody>
            </table>
        </div>

        <div class="lineup-summary mt-3">
            <div class="row">
                <div class="col-md-2">
                    <strong>Total Salary:</strong> <span id="total-salary">$0</span>
                </div>
                <div class="col-md-2">
                    <strong>Projected Points:</strong> <span id="total-projected">0</span>
                </div>
                <div class="col-md-2">
                    <strong>Win %:</strong> <span id="win-percentage">0%</span>
                </div>
                <div class="col-md-2">
                    <strong>Top 10%:</strong> <span id="top-ten-percentage">0%</span>
                </div>
                <div class="col-md-2">
                    <strong>Stack:</strong> <span id="lineup-stack">-</span>
                </div>
                <div class="col-md-1">
                    <strong>Type:</strong> <span id="lineup-type">-</span>
                </div>
                <div class="col-md-1">
                    <strong>Ceiling:</strong> <span id="lineup-ceiling">-</span>
                </div>
            </div>
        </div>
    </div>

    <div id="loading-overlay" class="position-fixed top-0 start-0 w-100 h-100" style="display: none;">
        <div class="position-absolute top-50 start-50 translate-middle text-center">
            <div class="spinner-border text-primary mb-2" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <div>
                Running simulation...
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block scripts %}
<!-- Load config handling first -->
<script src="{% static 'js/simulator-config.js' %}"></script>
<!-- Then load lineup handling -->
<script src="{% static 'js/simulator-lineups.js' %}"></script>
{% endblock %}
